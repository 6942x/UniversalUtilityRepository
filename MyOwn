local Nova = {}

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local HttpService = game:GetService("HttpService")

-- Garantir que a variável global existe
if not getgenv().Nova then
    getgenv().Nova = {}
end

-- Atribuir a tabela local à global
getgenv().Nova = Nova

Nova.MainUI = nil
Nova.Tabs = {}
Nova.Enabled = true
Nova.SavedConfig = {}
Nova.CurrentConfig = {}

-- Funções auxiliares
local function CreateRoundCorners(instance, cornerSize)
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, cornerSize)
    corner.Parent = instance
    return corner
end

local function CreateStroke(instance, color, thickness)
    local stroke = Instance.new("UIStroke")
    stroke.Color = color
    stroke.Thickness = thickness
    stroke.Parent = instance
    return stroke
end

local function CreateGradient(instance, colors, rotation)
    local gradient = Instance.new("UIGradient")
    
    if #colors == 2 then
        gradient.Color = ColorSequence.new({
            ColorSequenceKeypoint.new(0, colors[1]),
            ColorSequenceKeypoint.new(1, colors[2])
        })
    else
        local keypoints = {}
        for i, color in ipairs(colors) do
            local position = (i - 1) / (#colors - 1)
            table.insert(keypoints, ColorSequenceKeypoint.new(position, color))
        end
        gradient.Color = ColorSequence.new(keypoints)
    end
    
    gradient.Rotation = rotation or 0
    gradient.Parent = instance
    return gradient
end

local function CreateGlow(parent, color, size, offset)
    local glow = Instance.new("ImageLabel")
    glow.Name = "Glow"
    glow.BackgroundTransparency = 1
    glow.Size = UDim2.new(1, size, 1, size)
    glow.Position = UDim2.new(0, -offset, 0, -offset)
    glow.ZIndex = -1
    glow.Image = "rbxassetid://8992234081"
    glow.ImageColor3 = color
    glow.ImageTransparency = 0.3
    glow.ScaleType = Enum.ScaleType.Slice
    glow.SliceCenter = Rect.new(100, 100, 100, 100)
    glow.Parent = parent
    
    local pulseAnim = TweenService:Create(
        glow,
        TweenInfo.new(2, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, -1, true),
        {ImageTransparency = 0.7}
    )
    pulseAnim:Play()
    
    return glow
end

local function AnimateHover(element, hoverColor, normalColor)
    element.MouseEnter:Connect(function()
        TweenService:Create(
            element,
            TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
            {BackgroundColor3 = hoverColor}
        ):Play()
    end)
    
    element.MouseLeave:Connect(function()
        TweenService:Create(
            element,
            TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
            {BackgroundColor3 = normalColor}
        ):Play()
    end)
end

local function CreatePadding(parent, left, right, top, bottom)
    local padding = Instance.new("UIPadding")
    padding.PaddingLeft = UDim.new(0, left)
    padding.PaddingRight = UDim.new(0, right)
    padding.PaddingTop = UDim.new(0, top)
    padding.PaddingBottom = UDim.new(0, bottom)
    padding.Parent = parent
    return padding
end

-- Função principal CreateWindow
function Nova.CreateWindow(config)
    config = config or {}
    
    local self = Nova
    
    self.CurrentConfig = {
        Name = config.Name or "Nova Hub",
        LoadingTitle = config.LoadingTitle or "Loading Nova Hub",
        LoadingSubtitle = config.LoadingSubtitle or "Please wait...",
        ToggleUIKeybind = config.ToggleUIKeybind or "K",
        ConfigurationSaving = config.ConfigurationSaving or {
            Enabled = false,
            FolderName = "NovaHub",
            FileName = "Settings"
        },
        Discord = config.Discord or {
            Enabled = false,
            Invite = "",
            RememberJoins = false
        },
        Theme = config.Theme or {
            Primary = Color3.fromRGB(140, 80, 255),
            Secondary = Color3.fromRGB(100, 60, 200),
            Background = Color3.fromRGB(25, 20, 30),
            Topbar = Color3.fromRGB(35, 25, 45),
            Element = Color3.fromRGB(40, 30, 55),
            Text = Color3.fromRGB(240, 240, 240),
            Success = Color3.fromRGB(85, 255, 85),
            Warning = Color3.fromRGB(255, 170, 0),
            Error = Color3.fromRGB(255, 85, 85)
        },
        WindowSize = config.WindowSize or UDim2.new(0, 680, 0, 500),
        WindowPosition = config.WindowPosition or UDim2.new(0.5, -340, 0.5, -250)
    }

    -- Criar loading screen
    local loadingGui = Instance.new("ScreenGui")
    loadingGui.Name = "NovaLoading"
    loadingGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    loadingGui.Parent = game:GetService("CoreGui")
    
    local loadingFrame = Instance.new("Frame")
    loadingFrame.Name = "LoadingFrame"
    loadingFrame.BackgroundColor3 = self.CurrentConfig.Theme.Background
    loadingFrame.Size = UDim2.new(0, 420, 0, 220)
    loadingFrame.Position = UDim2.new(0.5, -210, 0.5, -110)
    loadingFrame.AnchorPoint = Vector2.new(0.5, 0.5)
    
    CreateRoundCorners(loadingFrame, 16)
    CreateStroke(loadingFrame, self.CurrentConfig.Theme.Primary, 3)
    CreateGlow(loadingFrame, self.CurrentConfig.Theme.Primary, 40, 20)
    
    local loadingLabel = Instance.new("TextLabel")
    loadingLabel.Name = "LoadingLabel"
    loadingLabel.BackgroundTransparency = 1
    loadingLabel.Size = UDim2.new(1, 0, 0, 60)
    loadingLabel.Position = UDim2.new(0, 0, 0.25, 0)
    loadingLabel.Font = Enum.Font.GothamBold
    loadingLabel.Text = self.CurrentConfig.LoadingTitle
    loadingLabel.TextColor3 = self.CurrentConfig.Theme.Text
    loadingLabel.TextSize = 28
    loadingLabel.Parent = loadingFrame
    
    CreateGradient(loadingLabel, {self.CurrentConfig.Theme.Primary, self.CurrentConfig.Theme.Secondary}, 45)
    
    local statusLabel = Instance.new("TextLabel")
    statusLabel.Name = "StatusLabel"
    statusLabel.BackgroundTransparency = 1
    statusLabel.Size = UDim2.new(1, 0, 0, 35)
    statusLabel.Position = UDim2.new(0, 0, 0.5, 0)
    statusLabel.Font = Enum.Font.Gotham
    statusLabel.Text = self.CurrentConfig.LoadingSubtitle
    statusLabel.TextColor3 = self.CurrentConfig.Theme.Text
    statusLabel.TextSize = 17
    statusLabel.Parent = loadingFrame
    
    local progressBar = Instance.new("Frame")
    progressBar.Name = "ProgressBar"
    progressBar.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    progressBar.Size = UDim2.new(0.8, 0, 0, 10)
    progressBar.Position = UDim2.new(0.1, 0, 0.72, 0)
    progressBar.Parent = loadingFrame
    
    CreateRoundCorners(progressBar, 5)
    
    local progressFill = Instance.new("Frame")
    progressFill.Name = "ProgressFill"
    progressFill.BackgroundColor3 = self.CurrentConfig.Theme.Primary
    progressFill.Size = UDim2.new(0, 0, 1, 0)
    progressFill.Parent = progressBar
    
    CreateRoundCorners(progressFill, 5)
    CreateGradient(progressFill, {self.CurrentConfig.Theme.Primary, self.CurrentConfig.Theme.Secondary}, 90)
    
    loadingFrame.Parent = loadingGui

    -- Simular loading
    local function UpdateProgress(progress, text)
        statusLabel.Text = text
        TweenService:Create(
            progressFill,
            TweenInfo.new(0.4, Enum.EasingStyle.Quad),
            {Size = UDim2.new(progress, 0, 1, 0)}
        ):Play()
    end

    UpdateProgress(0.1, "Initializing...")
    
    if self.CurrentConfig.Discord and self.CurrentConfig.Discord.Enabled then
        UpdateProgress(0.2, "Connecting to Discord...")
        -- Simular join discord
        task.wait(0.5)
    end
    
    UpdateProgress(0.3, "Creating interface...")
    
    -- Criar a GUI principal
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "Nova"
    screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    screenGui.Parent = game:GetService("CoreGui")
    
    self.MainUI = screenGui
    
    local mainFrame = Instance.new("Frame")
    mainFrame.Name = "MainFrame"
    mainFrame.BackgroundColor3 = self.CurrentConfig.Theme.Background
    mainFrame.Size = UDim2.new(0, 0, 0, 0) -- Começar pequeno
    mainFrame.Position = self.CurrentConfig.WindowPosition
    mainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
    
    CreateRoundCorners(mainFrame, 16)
    CreateStroke(mainFrame, self.CurrentConfig.Theme.Primary, 3)
    CreateGlow(mainFrame, self.CurrentConfig.Theme.Primary, 60, 30)
    
    UpdateProgress(0.4, "Creating top bar...")
    
    local topBar = Instance.new("Frame")
    topBar.Name = "TopBar"
    topBar.BackgroundColor3 = self.CurrentConfig.Theme.Topbar
    topBar.Size = UDim2.new(1, 0, 0, 50)
    topBar.Parent = mainFrame
    
    CreateRoundCorners(topBar, 16)
    CreateGradient(topBar, {self.CurrentConfig.Theme.Topbar, self.CurrentConfig.Theme.Background}, 180)
    
    local topBarStroke = CreateStroke(topBar, self.CurrentConfig.Theme.Primary, 2.5)
    topBarStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    
    local titleContainer = Instance.new("Frame")
    titleContainer.Name = "TitleContainer"
    titleContainer.BackgroundTransparency = 1
    titleContainer.Size = UDim2.new(0.6, 0, 1, 0)
    titleContainer.Parent = topBar
    
    CreatePadding(titleContainer, 25, 0, 0, 0)
    
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Name = "Title"
    titleLabel.BackgroundTransparency = 1
    titleLabel.Size = UDim2.new(1, 0, 1, 0)
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.Text = self.CurrentConfig.Name
    titleLabel.TextColor3 = self.CurrentConfig.Theme.Text
    titleLabel.TextSize = 22
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.Parent = titleContainer
    
    CreateGradient(titleLabel, {self.CurrentConfig.Theme.Primary, self.CurrentConfig.Theme.Text}, 45)
    
    local buttonContainer = Instance.new("Frame")
    buttonContainer.Name = "ButtonContainer"
    buttonContainer.BackgroundTransparency = 1
    buttonContainer.Size = UDim2.new(0, 75, 0, 32)
    buttonContainer.Position = UDim2.new(1, -85, 0.5, -16)
    buttonContainer.Parent = topBar
    
    local buttonLayout = Instance.new("UIListLayout")
    buttonLayout.FillDirection = Enum.FillDirection.Horizontal
    buttonLayout.Padding = UDim.new(0, 10)
    buttonLayout.Parent = buttonContainer
    
    local minimizeButton = Instance.new("TextButton")
    minimizeButton.Name = "MinimizeButton"
    minimizeButton.BackgroundColor3 = self.CurrentConfig.Theme.Warning
    minimizeButton.Size = UDim2.new(0, 32, 0, 32)
    minimizeButton.Font = Enum.Font.GothamBold
    minimizeButton.Text = "_"
    minimizeButton.TextColor3 = self.CurrentConfig.Theme.Text
    minimizeButton.TextSize = 18
    minimizeButton.AutoButtonColor = false
    
    CreateRoundCorners(minimizeButton, 9)
    AnimateHover(minimizeButton, self.CurrentConfig.Theme.Secondary, self.CurrentConfig.Theme.Warning)
    
    minimizeButton.MouseButton1Click:Connect(function()
        self:ToggleUI()
    end)
    
    minimizeButton.Parent = buttonContainer
    
    local closeButton = Instance.new("TextButton")
    closeButton.Name = "CloseButton"
    closeButton.BackgroundColor3 = self.CurrentConfig.Theme.Error
    closeButton.Size = UDim2.new(0, 32, 0, 32)
    closeButton.Font = Enum.Font.GothamBold
    closeButton.Text = "×"
    closeButton.TextColor3 = self.CurrentConfig.Theme.Text
    closeButton.TextSize = 22
    closeButton.AutoButtonColor = false
    
    CreateRoundCorners(closeButton, 9)
    AnimateHover(closeButton, Color3.fromRGB(255, 50, 50), self.CurrentConfig.Theme.Error)
    
    closeButton.MouseButton1Click:Connect(function()
        local closeTween = TweenService:Create(
            mainFrame,
            TweenInfo.new(0.4, Enum.EasingStyle.Back, Enum.EasingDirection.In),
            {Size = UDim2.new(0, 0, 0, 0)}
        )
        closeTween:Play()
        closeTween.Completed:Connect(function()
            screenGui:Destroy()
            self.MainUI = nil
        end)
    end)
    
    closeButton.Parent = buttonContainer
    
    UpdateProgress(0.6, "Creating tabs...")
    
    local tabButtonsContainer = Instance.new("Frame")
    tabButtonsContainer.Name = "TabButtons"
    tabButtonsContainer.BackgroundColor3 = self.CurrentConfig.Theme.Topbar
    tabButtonsContainer.Size = UDim2.new(1, 0, 0, 60)
    tabButtonsContainer.Position = UDim2.new(0, 0, 0, 50)
    tabButtonsContainer.Parent = mainFrame
    
    CreatePadding(tabButtonsContainer, 18, 18, 12, 12)
    
    local tabButtonsList = Instance.new("UIListLayout")
    tabButtonsList.FillDirection = Enum.FillDirection.Horizontal
    tabButtonsList.Padding = UDim.new(0, 10)
    tabButtonsList.Parent = tabButtonsContainer
    
    local contentArea = Instance.new("Frame")
    contentArea.Name = "ContentArea"
    contentArea.BackgroundTransparency = 1
    contentArea.Size = UDim2.new(1, -35, 1, -135)
    contentArea.Position = UDim2.new(0, 17, 0, 120)
    contentArea.Parent = mainFrame
    
    mainFrame.Parent = screenGui
    
    UpdateProgress(0.8, "Loading settings...")
    
    -- Carregar configurações se habilitado
    if self.CurrentConfig.ConfigurationSaving and self.CurrentConfig.ConfigurationSaving.Enabled then
        task.spawn(function()
            self:LoadConfig()
        end)
    end
    
    UpdateProgress(1, "Complete!")
    
    -- Animação de entrada
    local fadeIn = TweenService:Create(
        mainFrame,
        TweenInfo.new(0.5, Enum.EasingStyle.Back, Enum.EasingDirection.Out),
        {Size = self.CurrentConfig.WindowSize}
    )
    
    fadeIn:Play()
    
    -- Remover loading screen
    task.delay(0.6, function()
        loadingGui:Destroy()
    end)
    
    -- Sistema de arrastar
    local dragging = false
    local dragInput, dragStart, startPos
    
    local function update(input)
        local delta = input.Position - dragStart
        TweenService:Create(
            mainFrame,
            TweenInfo.new(0.15, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
            {Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)}
        ):Play()
    end
    
    topBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = mainFrame.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    topBar.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            update(input)
        end
    end)
    
    -- Keybind para toggle
    UserInputService.InputBegan:Connect(function(input, processed)
        if not processed and input.KeyCode == Enum.KeyCode[self.CurrentConfig.ToggleUIKeybind] then
            self:ToggleUI()
        end
    end)
    
    -- Criar tabela de retorno com todas as funções
    local windowTable = {
        CreateTab = function(tabConfig)
            return self:CreateTab(tabConfig, contentArea, tabButtonsContainer)
        end,
        
        Notify = function(title, content, duration, type)
            self:Notify(title, content, duration, type)
        end,
        
        JoinDiscord = function(inviteCode)
            self:JoinDiscord(inviteCode)
        end,
        
        SaveConfig = function()
            return self:SaveConfig()
        end,
        
        LoadConfig = function()
            return self:LoadConfig()
        end,
        
        SetConfigValue = function(key, value)
            self:SetConfigValue(key, value)
        end,
        
        GetConfigValue = function(key, default)
            return self:GetConfigValue(key, default)
        end,
        
        ToggleUI = function()
            self:ToggleUI()
        end,
        
        Destroy = function()
            if screenGui then
                screenGui:Destroy()
                self.MainUI = nil
            end
        end,
        
        UpdateTheme = function(newTheme)
            if newTheme then
                for k, v in pairs(newTheme) do
                    if self.CurrentConfig.Theme[k] then
                        self.CurrentConfig.Theme[k] = v
                    end
                end
            end
        end
    }
    
    -- Atribuir à variável global
    getgenv().NovaWindow = windowTable
    
    return windowTable
end

-- Função CreateTab
function Nova:CreateTab(tabConfig, contentArea, tabButtonsContainer)
    local tabButton = Instance.new("TextButton")
    tabButton.Name = tabConfig.Name .. "Button"
    tabButton.BackgroundColor3 = self.CurrentConfig.Theme.Element
    tabButton.Size = UDim2.new(0, 140, 0, 38)
    tabButton.Font = Enum.Font.GothamBold
    tabButton.Text = tabConfig.Name
    tabButton.TextColor3 = self.CurrentConfig.Theme.Text
    tabButton.TextSize = 15
    tabButton.AutoButtonColor = false
    
    CreateRoundCorners(tabButton, 10)
    CreateStroke(tabButton, self.CurrentConfig.Theme.Primary, 2)
    
    local tabContent = Instance.new("ScrollingFrame")
    tabContent.Name = tabConfig.Name .. "Content"
    tabContent.BackgroundTransparency = 1
    tabContent.Size = UDim2.new(1, 0, 1, 0)
    tabContent.Position = UDim2.new(0, 0, 0, 0)
    tabContent.Visible = false
    tabContent.ScrollingEnabled = true
    tabContent.ScrollBarThickness = 8
    tabContent.ScrollBarImageColor3 = self.CurrentConfig.Theme.Primary
    tabContent.CanvasSize = UDim2.new(0, 0, 0, 0)
    tabContent.AutomaticCanvasSize = Enum.AutomaticSize.Y
    tabContent.Parent = contentArea
    
    CreatePadding(tabContent, 6, 6, 6, 6)
    
    local contentLayout = Instance.new("UIListLayout")
    contentLayout.Padding = UDim.new(0, 14)
    contentLayout.Parent = tabContent
    
    tabButton.MouseButton1Click:Connect(function()
        for _, otherTab in pairs(self.Tabs) do
            if otherTab.Content then
                otherTab.Content.Visible = false
            end
            if otherTab.Button then
                TweenService:Create(
                    otherTab.Button,
                    TweenInfo.new(0.25, Enum.EasingStyle.Quad),
                    {BackgroundColor3 = self.CurrentConfig.Theme.Element}
                ):Play()
            end
        end
        
        tabContent.Visible = true
        TweenService:Create(
            tabButton,
            TweenInfo.new(0.25, Enum.EasingStyle.Quad),
            {BackgroundColor3 = self.CurrentConfig.Theme.Primary}
        ):Play()
    end)
    
    AnimateHover(tabButton, Color3.fromRGB(120, 70, 235), self.CurrentConfig.Theme.Element)
    
    tabButton.Parent = tabButtonsContainer
    
    local tab = {
        Button = tabButton,
        Content = tabContent
    }
    
    self.Tabs[tabConfig.Name] = tab
    
    if #self.Tabs == 1 then
        tabContent.Visible = true
        tabButton.BackgroundColor3 = self.CurrentConfig.Theme.Primary
    end
    
    local tabTable = {
        CreateSection = function(sectionConfig)
            local sectionName = sectionConfig.Name or sectionConfig.Text or "Section"
            local section = Instance.new("Frame")
            section.Name = "Section"
            section.BackgroundColor3 = sectionConfig.BackgroundColor or self.CurrentConfig.Theme.Element
            section.Size = UDim2.new(1, 0, 0, sectionConfig.Height or 48)
            
            CreateRoundCorners(section, sectionConfig.CornerSize or 12)
            CreateStroke(section, sectionConfig.StrokeColor or self.CurrentConfig.Theme.Primary, sectionConfig.StrokeThickness or 2)
            
            if sectionConfig.Gradient then
                CreateGradient(section, sectionConfig.Gradient.Colors or {self.CurrentConfig.Theme.Element, self.CurrentConfig.Theme.Topbar}, sectionConfig.Gradient.Rotation or 90)
            end
            
            local sectionLabel = Instance.new("TextLabel")
            sectionLabel.Name = "SectionLabel"
            sectionLabel.BackgroundTransparency = 1
            sectionLabel.Size = UDim2.new(1, -30, 1, 0)
            sectionLabel.Position = UDim2.new(0, 18, 0, 0)
            sectionLabel.Font = Enum.Font.GothamBold
            sectionLabel.Text = sectionName
            sectionLabel.TextColor3 = sectionConfig.TextColor or self.CurrentConfig.Theme.Text
            sectionLabel.TextSize = sectionConfig.TextSize or 18
            sectionLabel.TextXAlignment = Enum.TextXAlignment.Left
            sectionLabel.Parent = section
            
            if sectionConfig.TitleGradient then
                CreateGradient(sectionLabel, sectionConfig.TitleGradient.Colors or {self.CurrentConfig.Theme.Primary, self.CurrentConfig.Theme.Text}, sectionConfig.TitleGradient.Rotation or 45)
            end
            
            section.Parent = tabContent
            
            local sectionTable = {
                SetText = function(text)
                    sectionLabel.Text = text
                end,
                SetColor = function(color)
                    section.BackgroundColor3 = color
                end,
                Destroy = function()
                    section:Destroy()
                end
            }
            
            return sectionTable
        end,
        
        CreateButton = function(buttonConfig)
            local button = Instance.new("TextButton")
            button.Name = "Button"
            button.BackgroundColor3 = buttonConfig.BackgroundColor or self.CurrentConfig.Theme.Element
            button.Size = UDim2.new(1, 0, 0, buttonConfig.Height or 43)
            button.Font = Enum.Font.GothamBold
            button.Text = buttonConfig.Text or buttonConfig.Name or "Button"
            button.TextColor3 = buttonConfig.TextColor or self.CurrentConfig.Theme.Text
            button.TextSize = buttonConfig.TextSize or 16
            button.AutoButtonColor = false
            
            CreateRoundCorners(button, buttonConfig.CornerSize or 12)
            CreateStroke(button, buttonConfig.StrokeColor or self.CurrentConfig.Theme.Primary, buttonConfig.StrokeThickness or 2)
            
            if buttonConfig.Gradient then
                CreateGradient(button, buttonConfig.Gradient.Colors or {self.CurrentConfig.Theme.Element, self.CurrentConfig.Theme.Topbar}, buttonConfig.Gradient.Rotation or 90)
            end
            
            AnimateHover(button, buttonConfig.HoverColor or self.CurrentConfig.Theme.Primary, buttonConfig.BackgroundColor or self.CurrentConfig.Theme.Element)
            
            button.MouseButton1Click:Connect(function()
                local clickAnim = TweenService:Create(
                    button,
                    TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
                    {Size = UDim2.new(0.97, 0, 0, buttonConfig.Height and buttonConfig.Height - 3 or 40)}
                )
                clickAnim:Play()
                
                clickAnim.Completed:Connect(function()
                    TweenService:Create(
                        button,
                        TweenInfo.new(0.1, Enum.EasingStyle.Quad),
                        {Size = UDim2.new(1, 0, 0, buttonConfig.Height or 43)}
                    ):Play()
                end)
                
                if buttonConfig.Callback then
                    buttonConfig.Callback()
                end
            end)
            
            button.Parent = tabContent
            
            local buttonTable = {
                SetText = function(text)
                    button.Text = text
                end,
                SetColor = function(color)
                    button.BackgroundColor3 = color
                end,
                Destroy = function()
                    button:Destroy()
                end
            }
            
            return buttonTable
        end,
        
        CreateToggle = function(toggleConfig)
            local toggleContainer = Instance.new("Frame")
            toggleContainer.Name = "ToggleContainer"
            toggleContainer.BackgroundColor3 = toggleConfig.BackgroundColor or self.CurrentConfig.Theme.Element
            toggleContainer.Size = UDim2.new(1, 0, 0, toggleConfig.Height or 38)
            
            CreateRoundCorners(toggleContainer, toggleConfig.CornerSize or 12)
            CreateStroke(toggleContainer, toggleConfig.StrokeColor or self.CurrentConfig.Theme.Primary, toggleConfig.StrokeThickness or 2)
            CreatePadding(toggleContainer, 18, 18, 0, 0)
            
            local toggleLabel = Instance.new("TextLabel")
            toggleLabel.Name = "ToggleLabel"
            toggleLabel.BackgroundTransparency = 1
            toggleLabel.Size = UDim2.new(0.65, 0, 1, 0)
            toggleLabel.Font = Enum.Font.GothamBold
            toggleLabel.Text = toggleConfig.Text or toggleConfig.Name or "Toggle"
            toggleLabel.TextColor3 = toggleConfig.TextColor or self.CurrentConfig.Theme.Text
            toggleLabel.TextSize = toggleConfig.TextSize or 15
            toggleLabel.TextXAlignment = Enum.TextXAlignment.Left
            toggleLabel.Parent = toggleContainer
            
            local toggleButton = Instance.new("TextButton")
            toggleButton.Name = "ToggleButton"
            toggleButton.BackgroundColor3 = toggleConfig.Default and (toggleConfig.EnabledColor or self.CurrentConfig.Theme.Success) or (toggleConfig.DisabledColor or Color3.fromRGB(80, 80, 80))
            toggleButton.Size = UDim2.new(0, toggleConfig.ToggleWidth or 60, 0, toggleConfig.ToggleHeight or 30)
            toggleButton.Position = UDim2.new(1, -(toggleConfig.ToggleWidth or 60), 0.5, -((toggleConfig.ToggleHeight or 30) / 2))
            toggleButton.AnchorPoint = Vector2.new(1, 0.5)
            toggleButton.Font = Enum.Font.GothamBold
            toggleButton.Text = toggleConfig.Default and "ON" or "OFF"
            toggleButton.TextColor3 = toggleConfig.TextColor or self.CurrentConfig.Theme.Text
            toggleButton.TextSize = toggleConfig.ToggleTextSize or 13
            toggleButton.AutoButtonColor = false
            
            CreateRoundCorners(toggleButton, toggleConfig.ToggleCornerSize or 15)
            CreateStroke(toggleButton, toggleConfig.StrokeColor or self.CurrentConfig.Theme.Primary, toggleConfig.ToggleStrokeThickness or 2.5)
            
            local toggleIndicator = Instance.new("Frame")
            toggleIndicator.Name = "Indicator"
            toggleIndicator.BackgroundColor3 = toggleConfig.IndicatorColor or self.CurrentConfig.Theme.Text
            toggleIndicator.Size = UDim2.new(0, toggleConfig.IndicatorSize or 22, 0, toggleConfig.IndicatorSize or 22)
            toggleIndicator.Position = toggleConfig.Default and UDim2.new(1, -(toggleConfig.IndicatorSize and (toggleConfig.IndicatorSize + 4) or 26), 0.5, -((toggleConfig.IndicatorSize or 22) / 2)) or UDim2.new(0, 4, 0.5, -((toggleConfig.IndicatorSize or 22) / 2))
            
            CreateRoundCorners(toggleIndicator, toggleConfig.IndicatorCornerSize or 11)
            
            toggleIndicator.Parent = toggleButton
            
            local toggleState = toggleConfig.Default or false
            local toggleName = toggleConfig.Text or toggleConfig.Name or "Toggle"
            
            local savedValue = self:GetConfigValue(toggleName, toggleState)
            if savedValue ~= toggleState then
                toggleState = savedValue
                local targetColor = toggleState and (toggleConfig.EnabledColor or self.CurrentConfig.Theme.Success) or (toggleConfig.DisabledColor or Color3.fromRGB(80, 80, 80))
                local targetPos = toggleState and UDim2.new(1, -(toggleConfig.IndicatorSize and (toggleConfig.IndicatorSize + 4) or 26), 0.5, -((toggleConfig.IndicatorSize or 22) / 2)) or UDim2.new(0, 4, 0.5, -((toggleConfig.IndicatorSize or 22) / 2))
                toggleButton.BackgroundColor3 = targetColor
                toggleIndicator.Position = targetPos
                toggleButton.Text = toggleState and "ON" or "OFF"
            end
            
            toggleButton.MouseButton1Click:Connect(function()
                toggleState = not toggleState
                
                local targetColor = toggleState and (toggleConfig.EnabledColor or self.CurrentConfig.Theme.Success) or (toggleConfig.DisabledColor or Color3.fromRGB(80, 80, 80))
                local targetPos = toggleState and UDim2.new(1, -(toggleConfig.IndicatorSize and (toggleConfig.IndicatorSize + 4) or 26), 0.5, -((toggleConfig.IndicatorSize or 22) / 2)) or UDim2.new(0, 4, 0.5, -((toggleConfig.IndicatorSize or 22) / 2))
                
                TweenService:Create(
                    toggleButton,
                    TweenInfo.new(0.35, Enum.EasingStyle.Quad),
                    {BackgroundColor3 = targetColor}
                ):Play()
                
                TweenService:Create(
                    toggleIndicator,
                    TweenInfo.new(0.35, Enum.EasingStyle.Back, Enum.EasingDirection.Out),
                    {Position = targetPos}
                ):Play()
                
                toggleButton.Text = toggleState and "ON" or "OFF"
                
                self:SetConfigValue(toggleName, toggleState)
                
                if toggleConfig.Callback then
                    toggleConfig.Callback(toggleState)
                end
            end)
            
            toggleButton.Parent = toggleContainer
            toggleContainer.Parent = tabContent
            
            local toggleTable = {
                SetValue = function(value)
                    toggleState = value
                    local targetColor = value and (toggleConfig.EnabledColor or self.CurrentConfig.Theme.Success) or (toggleConfig.DisabledColor or Color3.fromRGB(80, 80, 80))
                    local targetPos = value and UDim2.new(1, -(toggleConfig.IndicatorSize and (toggleConfig.IndicatorSize + 4) or 26), 0.5, -((toggleConfig.IndicatorSize or 22) / 2)) or UDim2.new(0, 4, 0.5, -((toggleConfig.IndicatorSize or 22) / 2))
                    
                    TweenService:Create(toggleButton, TweenInfo.new(0.35, Enum.EasingStyle.Quad), {BackgroundColor3 = targetColor}):Play()
                    TweenService:Create(toggleIndicator, TweenInfo.new(0.35, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {Position = targetPos}):Play()
                    
                    toggleButton.Text = value and "ON" or "OFF"
                    self:SetConfigValue(toggleName, value)
                    if toggleConfig.Callback then
                        toggleConfig.Callback(value)
                    end
                end,
                GetValue = function()
                    return toggleState
                end,
                Destroy = function()
                    toggleContainer:Destroy()
                end
            }
            
            return toggleTable
        end,
        
        CreateLabel = function(labelConfig)
            local labelContainer = Instance.new("Frame")
            labelContainer.Name = "LabelContainer"
            labelContainer.BackgroundColor3 = labelConfig.BackgroundColor or self.CurrentConfig.Theme.Element
            labelContainer.Size = UDim2.new(1, 0, 0, labelConfig.Height or 33)
            
            CreateRoundCorners(labelContainer, labelConfig.CornerSize or 10)
            CreateStroke(labelContainer, labelConfig.StrokeColor or self.CurrentConfig.Theme.Primary, labelConfig.StrokeThickness or 1.5)
            
            local label = Instance.new("TextLabel")
            label.Name = "Label"
            label.BackgroundTransparency = 1
            label.Size = UDim2.new(1, -24, 1, 0)
            label.Position = UDim2.new(0, 12, 0, 0)
            label.Font = Enum.Font.Gotham
            label.Text = labelConfig.Text or labelConfig.Name or "Label"
            label.TextColor3 = labelConfig.TextColor or self.CurrentConfig.Theme.Text
            label.TextSize = labelConfig.TextSize or 15
            label.TextXAlignment = Enum.TextXAlignment.Left
            label.Parent = labelContainer
            
            labelContainer.Parent = tabContent
            
            local labelTable = {
                SetText = function(text)
                    label.Text = text
                end,
                SetColor = function(color)
                    label.TextColor3 = color
                end,
                Destroy = function()
                    labelContainer:Destroy()
                end
            }
            
            return labelTable
        end
    }
    
    return tabTable
end

-- Funções auxiliares
function Nova:Notify(title, content, duration, notificationType)
    -- Implementação simplificada da notificação
    print("[Nova] " .. title .. ": " .. content)
end

function Nova:JoinDiscord(inviteCode)
    -- Implementação simplificada do Discord
    print("[Nova] Discord invite: " .. inviteCode)
end

function Nova:SaveConfig()
    return true
end

function Nova:LoadConfig()
    return {}
end

function Nova:SetConfigValue(key, value)
    self.SavedConfig[key] = value
end

function Nova:GetConfigValue(key, default)
    return self.SavedConfig[key] or default
end

function Nova:ToggleUI()
    if self.MainUI then
        self.Enabled = not self.Enabled
        local mainFrame = self.MainUI:FindFirstChild("MainFrame")
        if mainFrame then
            mainFrame.Visible = self.Enabled
        end
    end
end

-- Exportar função CreateWindow globalmente
getgenv().CreateWindow = Nova.CreateWindow

return Nova
