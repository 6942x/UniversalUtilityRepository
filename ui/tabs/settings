local Config = _G.UniversalUtility.Config
local UI = _G.UniversalUtility.UI
local Interactions = _G.UniversalUtility.Interactions
local KeyCodeNames = _G.UniversalUtility.KeyCodeNames
local SettingsContent = UI.TabContents["Settings"]

local SettingsContainer = Instance.new("Frame", SettingsContent)
SettingsContainer.Size = UDim2.new(1, 0, 0, 180)
SettingsContainer.BackgroundColor3 = Color3.fromRGB(35, 35, 42)
SettingsContainer.BorderSizePixel = 0
SettingsContainer.LayoutOrder = 1

local SettingsCorner = Instance.new("UICorner", SettingsContainer)
SettingsCorner.CornerRadius = UDim.new(0, 10)

local SettingsTitle = Instance.new("TextLabel", SettingsContainer)
SettingsTitle.Size = UDim2.new(1, -20, 0, 24)
SettingsTitle.Position = UDim2.new(0, 10, 0, 10)
SettingsTitle.BackgroundTransparency = 1
SettingsTitle.Text = "UI Settings"
SettingsTitle.Font = Enum.Font.GothamBold
SettingsTitle.TextSize = 16
SettingsTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
SettingsTitle.TextXAlignment = Enum.TextXAlignment.Left

local KeybindButton = UI.CreateButton(SettingsContainer, UDim2.new(0, 220, 0, 40), "Toggle Keybind: G")
KeybindButton.Position = UDim2.new(0.5, 0, 0, 60)

local KeybindStatus = Instance.new("TextLabel", SettingsContainer)
KeybindStatus.Size = UDim2.new(1, -20, 0, 60)
KeybindStatus.Position = UDim2.new(0, 10, 0, 115)
KeybindStatus.BackgroundTransparency = 1
KeybindStatus.Text = "Click the button above to change your Toggle Keybind\n\nPress the keybind at any time to open / close this menu."
KeybindStatus.Font = Enum.Font.Gotham
KeybindStatus.TextSize = 16
KeybindStatus.TextColor3 = Color3.fromRGB(150, 150, 150)
KeybindStatus.TextXAlignment = Enum.TextXAlignment.Center
KeybindStatus.TextWrapped = true

KeybindButton.MouseButton1Click:Connect(function()
    KeybindButton.Text = "Press any key..."
    KeybindStatus.Text = "Waiting for input..."
    KeybindStatus.TextColor3 = Color3.fromRGB(255, 200, 100)
    KeybindButton.Active = false
    
    Interactions.ChangeKeybind(function(success, result)
        KeybindButton.Active = true
        
        if success then
            local keyName = KeyCodeNames[result] or result.Name
            KeybindButton.Text = "Toggle Keybind: " .. keyName
            KeybindStatus.Text = "Keybind changed successfully!\n\nPress the keybind at any time to open/close this menu."
            KeybindStatus.TextColor3 = Color3.fromRGB(50, 220, 100)
            
            task.wait(1.5)
            if KeybindStatus.Text:match("successfully") then
                KeybindStatus.Text = "Click the button above to change your Toggle Keybind\n\nPress the keybind at any time to open/close this menu."
                KeybindStatus.TextColor3 = Color3.fromRGB(150, 150, 150)
            end
        else
            KeybindButton.Text = "Toggle Keybind: " .. (KeyCodeNames[Config.Keybind] or Config.Keybind.Name)
            KeybindStatus.Text = "Timeout - Click again to retry"
            KeybindStatus.TextColor3 = Color3.fromRGB(255, 100, 100)
            task.wait(2)
            if KeybindStatus.Text:match("Timeout") then
                KeybindStatus.Text = "Click the button above to change your Toggle Keybind\n\nPress the keybind at any time to open/close this menu."
                KeybindStatus.TextColor3 = Color3.fromRGB(150, 150, 150)
            end
        end
    end)
end)

_G.UniversalUtility.SettingsTab = {
    KeybindButton = KeybindButton,
    KeybindStatus = KeybindStatus
}

print("[Universal Utility] Settings tab loaded")
