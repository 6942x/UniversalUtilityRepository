local TweenService = game:GetService("TweenService")

local Config = _G.UniversalUtility.Config
local UI = _G.UniversalUtility.UI
local AutoRejoin = _G.UniversalUtility.AutoRejoin
local Debounces = _G.UniversalUtility.Debounces
local RejoinContent = UI.TabContents["Auto Rejoin"]

local function SetDebounce(key, duration)
    if Debounces[key] then return false end
    Debounces[key] = true
    task.delay(duration or 0.3, function() Debounces[key] = false end)
    return true
end

local RejoinContainer = Instance.new("Frame", RejoinContent)
RejoinContainer.Size = UDim2.new(1, 0, 0, 200)
RejoinContainer.BackgroundColor3 = Color3.fromRGB(35, 35, 42)
RejoinContainer.BorderSizePixel = 0
RejoinContainer.LayoutOrder = 1

local RejoinCorner = Instance.new("UICorner", RejoinContainer)
RejoinCorner.CornerRadius = UDim.new(0, 10)

local RejoinTitle = Instance.new("TextLabel", RejoinContainer)
RejoinTitle.Size = UDim2.new(1, -20, 0, 24)
RejoinTitle.Position = UDim2.new(0, 10, 0, 10)
RejoinTitle.BackgroundTransparency = 1
RejoinTitle.Text = "Auto Rejoin"
RejoinTitle.Font = Enum.Font.GothamBold
RejoinTitle.TextSize = 16
RejoinTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
RejoinTitle.TextXAlignment = Enum.TextXAlignment.Left

local AutoRejoinToggle = UI.CreateButton(RejoinContainer, UDim2.new(0, 180, 0, 40), "Auto Rejoin: OFF")
AutoRejoinToggle.Position = UDim2.new(0.5, 0, 0, 60)

local AutoRejoinStatus = Instance.new("TextLabel", RejoinContainer)
AutoRejoinStatus.Size = UDim2.new(1, -20, 0, 70)
AutoRejoinStatus.Position = UDim2.new(0, 10, 0, 120)
AutoRejoinStatus.BackgroundTransparency = 1
AutoRejoinStatus.Text = "Status: Disabled\n\nAutomatically rejoins the game when you get disconnected.\nUseful for preventing AFK kicks."
AutoRejoinStatus.Font = Enum.Font.Gotham
AutoRejoinStatus.TextSize = 16
AutoRejoinStatus.TextColor3 = Color3.fromRGB(180, 180, 180)
AutoRejoinStatus.TextXAlignment = Enum.TextXAlignment.Center
AutoRejoinStatus.TextWrapped = true

AutoRejoinToggle.MouseButton1Click:Connect(function()
    if not SetDebounce("Rejoin", 0.3) then return end
    local enabled = AutoRejoin.Toggle()
    
    TweenService:Create(AutoRejoinToggle, UI.TweenPresets.Medium, {
        BackgroundColor3 = enabled and Color3.fromRGB(50, 220, 100) or Color3.fromRGB(220, 50, 50)
    }):Play()
    
    AutoRejoinToggle.Text = "Auto Rejoin: " .. (enabled and "ON" or "OFF")
    AutoRejoinStatus.Text = "Status: " .. (enabled and "Enabled" or "Disabled") .. "\n\nAutomatically rejoins the game when you get disconnected.\nUseful for preventing AFK kicks."
    AutoRejoinStatus.TextColor3 = enabled and Color3.fromRGB(50, 220, 100) or Color3.fromRGB(180, 180, 180)
end)

_G.UniversalUtility.AutoRejoinTab = {
    AutoRejoinToggle = AutoRejoinToggle,
    AutoRejoinStatus = AutoRejoinStatus
}

print("[Universal Utility] Auto Rejoin tab loaded")
