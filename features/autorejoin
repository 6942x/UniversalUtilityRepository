local Players = game:GetService("Players")
local TeleportService = game:GetService("TeleportService")
local CoreGui = game:GetService("CoreGui")

local LocalPlayer = Players.LocalPlayer
local teleporting = false

local AutoRejoin = {}

function AutoRejoin.Setup(config)
    if config.AutoRejoinEnabled then
        local PromptGui = CoreGui:WaitForChild("RobloxPromptGui")
        local PromptOverlay = PromptGui:WaitForChild("promptOverlay")
        PromptOverlay.ChildAdded:Connect(function(child)
            if child.Name == "ErrorPrompt" and config.AutoRejoinEnabled and not teleporting then
                teleporting = true
                task.spawn(function()
                    while config.AutoRejoinEnabled and teleporting do
                        TeleportService:Teleport(game.PlaceId, LocalPlayer)
                        task.wait(2)
                    end
                end)
            end
        end)
    end
end

function AutoRejoin.Stop()
    teleporting = false
end

return AutoRejoin
